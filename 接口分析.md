---
name: "test-guide"
description: "大模型测试指导专用技能，用户请求分析接口方法、生成测试可视化页面时触发，核心按从上到下逐方法分析，并生成含错误/警告模块、可展开查看详情的测试分析HTML页面。"
---

# Test Guide 核心技能
## 一、核心测试分析流程（从上到下逐方法执行）
### Step 1: 索取核心资料
向用户索要**接口/方法清单、需求文档*，明确待测试方法的先后顺序。如果没有需求文档就单纯进行方法分析即可。
### Step 2: 全局问题识别
先梳理两类全局问题，单独归集：
- **Error级**：会导致**系统无法启动/核心服务崩溃**的严重错误
- **Warning级**：高危操作、开发不规范、边界条件缺失等潜在风险问题
### Step 3: 逐方法结构化分析
按从上到下的顺序，对每个方法依次拆解分析，核心提取3类信息：
- 输入：参数类型/约束、入参对象属性、请求头/消息体格式
- 处理：核心业务逻辑、执行的SQL/调用的依赖、权限/校验规则
- 输出：返回值类型、出参对象属性、响应消息体/SQL执行结果、异常返回格式
### Step 4: 方法级风险标注
对每个方法标注**低/中/高**风险等级，核心关联Warning级全局问题，融入方法分析卡片。

## 二、HTML测试分析页面生成规则
### 1. 页面核心结构（从上到下）
`Error全局模块` → `Warning全局模块` → `方法分析卡片模块`
每个模块独立分区，Error/Warning为可折叠面板，方法卡片保持原可折叠+二级展开逻辑，整体页面层级清晰。

### 2. 前端基础模板（AI直接复用生成，替换{xxx}占位符）
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>接口方法测试分析报告</title>
    <style>
        * {margin: 0; padding: 0; box-sizing: border-box; font-family: Microsoft YaHei, Consolas, monospace;}
        body {padding: 2rem; background: #f5f7fa;}
        .container {max-width: 1200px; margin: 0 auto;}
        .page-title {text-align: center; color: #2c3e50; margin-bottom: 2rem; font-weight: 600; font-size: 1.8rem;}
        /* 全局错误/警告模块样式 */
        .global-mod {background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 1.5rem;}
        .global-header {padding: 1rem 1.5rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #f0f0f0;}
        .global-title {display: flex; align-items: center; gap: 0.8rem; font-size: 1.1rem; font-weight: 600;}
        .error-icon {color: #c62828; font-size: 1.2rem;}
        .warning-icon {color: #f57c00; font-size: 1.2rem;}
        .global-count {padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.8rem; background: #f0f0f0; color: #616161;}
        .global-body {padding: 0 1.5rem; max-height: 0; overflow: hidden; transition: max-height 0.3s ease;}
        .global-body.open {max-height: 1000px; padding: 1rem 1.5rem 1.5rem;}
        .issue-item {padding: 0.8rem 0; border-bottom: 1px dashed #e0e0e0; line-height: 1.6; color: #424242;}
        .issue-item:last-child {border-bottom: none;}
        .issue-title {font-weight: 500; color: #2c3e50;}
        .issue-desc {font-size: 0.95rem; color: #616161; margin-top: 0.3rem;}
        /* 方法卡片样式 */
        .method-card {background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 1rem;}
        .card-header {padding: 1rem 1.5rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center;}
        .method-name {font-size: 1.1rem; font-weight: 600; color: #2c3e50;}
        .risk-tag {padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem; margin-right: 0.8rem;}
        .risk-low {background: #e8f5e9; color: #2e7d32;}
        .risk-mid {background: #fff3e0; color: #f57c00;}
        .risk-high {background: #ffebee; color: #c62828;}
        .card-body {padding: 0 1.5rem; max-height: 0; overflow: hidden; transition: max-height 0.3s ease;}
        .card-body.open {max-height: 2000px; padding: 0 1.5rem 1.5rem;}
        .detail-mod {margin-top: 1rem; border-left: 3px solid #e0e0e0; padding-left: 1rem;}
        .mod-title {font-size: 1rem; font-weight: 500; color: #424242; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;}
        .detail-content {font-size: 0.95rem; color: #616161; line-height: 1.6;}
        .expand-item {margin-top: 0.5rem; padding: 0.8rem; background: #fafafa; border-radius: 4px; font-size: 0.9rem; color: #2c3e50; white-space: pre-wrap;}
        /* 通用箭头样式 */
        .arrow {transition: transform 0.3s ease; font-size: 0.9rem;}
        .arrow.open {transform: rotate(180deg);}
    </style>
</head>
<body>
    <div class="container">
        <h1 class="page-title">接口方法测试分析报告</h1>

        <!-- 全局ERROR模块：系统无法启动/崩溃的严重错误 -->
        <div class="global-mod">
            <div class="global-header" onclick="toggleGlobal(this)">
                <div class="global-title">
                    <span class="error-icon">?</span>
                    全局严重错误
                </div>
                <div>
                    <span class="global-count">共{error数量}项</span>
                    <span class="arrow"></span>
                </div>
            </div>
            <div class="global-body">
                <!-- AI循环生成error项，替换{xxx} -->
                <div class="issue-item">
                    <div class="issue-title">{错误编号/名称}</div>
                    <div class="issue-desc">{错误详情：如配置缺失、依赖包错误、初始化失败等，明确影响范围}</div>
                </div>
            </div>
        </div>

        <!-- 全局WARNING模块：高危操作/开发不规范/潜在风险 -->
        <div class="global-mod">
            <div class="global-header" onclick="toggleGlobal(this)">
                <div class="global-title">
                    <span class="warning-icon">??</span>
                    全局警告（高危/不规范）
                </div>
                <div>
                    <span class="global-count">共{warning数量}项</span>
                    <span class="arrow"></span>
                </div>
            </div>
            <div class="global-body">
                <!-- AI循环生成warning项，替换{xxx} -->
                <div class="issue-item">
                    <div class="issue-title">{警告编号/名称}</div>
                    <div class="issue-desc">{警告详情：如无校验的物理删除、硬编码密钥、参数未做非空判断等，标注风险类型}</div>
                </div>
            </div>
        </div>

        <!-- 方法分析卡片模块：按从上到下顺序排列 -->
        <div class="method-list">
            <!-- 方法卡片：AI在此处循环生成，替换{xxx}占位符 -->
            <div class="method-card">
                <div class="card-header" onclick="toggleCard(this)">
                    <span class="method-name">{方法名/接口地址}</span>
                    <div>
                        <span class="risk-tag risk-{low/mid/high}">{风险等级}</span>
                        <span class="arrow"></span>
                    </div>
                </div>
                <div class="card-body">
                    <!-- 输入详情 -->
                    <div class="detail-mod">
                        <h3 class="mod-title">?? 输入</h3>
                        <div class="detail-content">{输入参数/约束/入参对象/请求头要求}</div>
                        <!-- 二级展开：对象属性/完整请求体 -->
                        <div class="expand-item">{入参对象属性示例：\nuserId: Number (必传，非负)\nuserName: String (必传，长度1-20)\n完整请求体JSON/SOAP消息体}</div>
                    </div>
                    <!-- 处理详情 -->
                    <div class="detail-mod">
                        <h3 class="mod-title">?? 处理</h3>
                        <div class="detail-content">{核心业务逻辑/依赖服务调用/权限校验/数据处理规则}</div>
                        <!-- 二级展开：执行SQL/核心处理片段 -->
                        <div class="expand-item">{执行的SQL语句：\nSELECT * FROM user WHERE id = #{userId};\n调用的依赖方法：com.service.UserService.checkAuth()}</div>
                    </div>
                    <!-- 输出详情 -->
                    <div class="detail-mod">
                        <h3 class="mod-title">?? 输出</h3>
                        <div class="detail-content">{返回值类型/响应格式/正常/异常返回结果}</div>
                        <!-- 二级展开：出参对象属性/完整响应体 -->
                        <div class="expand-item">{出参对象属性示例：\ncode: Int (200成功/500异常)\ndata: Object (用户信息)\n完整响应体JSON：\n{\n  "code":200,\n  "msg":"success",\n  "data":{}\n}}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 方法卡片折叠/展开
        function toggleCard(header) {
            const body = header.nextElementSibling;
            const arrow = header.querySelector('.arrow');
            body.classList.toggle('open');
            arrow.classList.toggle('open');
        }
        // 全局Error/Warning模块折叠/展开
        function toggleGlobal(header) {
            const body = header.nextElementSibling;
            const arrow = header.querySelector('.arrow');
            body.classList.toggle('open');
            arrow.classList.toggle('open');
        }
    </script>
</body>
</html>
```

### 3. 页面交互&内容要求
1. **全局模块**：Error/Warning模块默认折叠，点击头部展开/收起，显示问题数量统计，每个问题含「标题+详情」，层级清晰；
2. **Error模块内容**：仅归集**系统无法启动、核心服务崩溃、初始化失败**等致命问题，如配置文件缺失、依赖包版本冲突、数据库连接失败、启动类注解错误等；
3. **Warning模块内容**：包含**高危操作**（无授权的物理删除、事务未提交/回滚、多线程无锁控制）、**开发不规范**（硬编码、参数无校验、异常未捕获）、**潜在风险**（边界值未处理、空指针隐患）等；
4. **方法卡片**：保留原「输入/处理/输出」二级展开、风险标签（低/中/高）、折叠动画，风险等级可关联全局Warning模块的对应问题；
5. **格式优化**：代码/JSON/SQL等技术内容用`white-space: pre-wrap`保留格式，提升可读性。

## 三、核心工作原则
1. 分析顺序：先识别**全局Error→全局Warning**，再**从上到下**逐方法分析，不跨方法、不遗漏；
2. 信息聚焦：Error仅保留致命问题，Warning仅保留高危/不规范点，方法分析仅聚焦「输入/处理/输出+风险等级」；
3. 生成落地：AI直接替换模板中`{xxx}`占位符即可生成可运行HTML，无需额外修改，所有模块均支持折叠；
4. 关联一致性：方法卡片的高风险等级，可对应全局Warning模块的具体问题，保证分析的连贯性。

## 四、触发场景
用户提出以下需求时，直接调用本技能：
- 需按顺序分析接口/方法的测试点并梳理全局问题；
- 要求生成含错误/警告标注的测试分析可视化页面；
- 需编写结构化的测试计划/测试用例，识别系统致命错误和高危风险；
- 需梳理方法的输入输出、核心处理逻辑及全局开发不规范点。

### 总结
1. 新增**全局Error、Warning模块**，置于方法分析上方，分别归集系统致命错误、高危/不规范操作，形成「全局问题→方法细节」的分析逻辑；
2. 优化HTML模板，补充全局模块的折叠/展开逻辑、数量统计、问题项结构，技术内容保留原始格式，提升可读性；
3. 完善交互体验，全局模块和方法卡片均默认折叠，可独立展开/收起，页面层级清晰不杂乱；
4. 明确了Error/Warning模块的内容边界，避免两类问题混淆，让测试分析的重点更突出。